{
  "version": 3,
  "sources": ["../../../../src/api/getSmiles.ts"],
  "sourcesContent": ["import { CachedSmiles, Smile, SmileCategory } from \"../types\"\nimport { parseJson } from \"../utils/api\"\n\n/**\n * \u041F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0435 \u0441\u043F\u0438\u0441\u043A\u0430 \u0441\u043C\u0430\u0439\u043B\u043E\u0432 \u0441 \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435\u043C\n * @returns Promise \u0441 \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u043C\u0438 \u0441\u043C\u0430\u0439\u043B\u0430\u043C\u0438\n */\nexport const getSmiles = (() => {\n\tlet cachedSmiles: CachedSmiles | null = null\n\tlet isLoading = false\n\tlet loadPromise: Promise<CachedSmiles> | null = null\n\n\treturn async (): Promise<CachedSmiles> => {\n\t\t// \u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043C \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\n\t\tif (cachedSmiles) return cachedSmiles\n\n\t\t// \u0415\u0441\u043B\u0438 \u0443\u0436\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044F, \u0436\u0434\u0435\u043C \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0438\u044F\n\t\tif (isLoading && loadPromise) return loadPromise\n\n\t\t// \u041D\u0430\u0447\u0438\u043D\u0430\u0435\u043C \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0443\n\t\tisLoading = true\n\t\tloadPromise = (async () => {\n\t\t\ttry {\n\t\t\t\tconst response = await parseJson<{\n\t\t\t\t\tsmiles: {\n\t\t\t\t\t\tcategories: SmileCategory[]\n\t\t\t\t\t\tsmiles: Record<string, Smile[]>\n\t\t\t\t\t}\n\t\t\t\t}>(\"/replies/get_smiles\", {})\n\n\t\t\t\tcachedSmiles = {\n\t\t\t\t\tcategories: response.smiles.categories ?? [],\n\t\t\t\t\tsmiles: Object.values(response.smiles.smiles).flat(),\n\t\t\t\t}\n\n\t\t\t\treturn cachedSmiles\n\t\t\t} finally {\n\t\t\t\tisLoading = false\n\t\t\t\tloadPromise = null\n\t\t\t}\n\t\t})()\n\n\t\treturn loadPromise\n\t}\n})()\n"],
  "mappings": ";;;;;AAOO,IAAM,YAAa,uBAAM;AAC/B,MAAI,eAAoC;AACxC,MAAI,YAAY;AAChB,MAAI,cAA4C;AAEhD,SAAO,YAAmC;AAEzC,QAAI,aAAc,QAAO;AAGzB,QAAI,aAAa,YAAa,QAAO;AAGrC,gBAAY;AACZ,mBAAe,YAAY;AAC1B,UAAI;AACH,cAAM,WAAW,MAAM,UAKpB,uBAAuB,CAAC,CAAC;AAE5B,uBAAe;AAAA,UACd,YAAY,SAAS,OAAO,cAAc,CAAC;AAAA,UAC3C,QAAQ,OAAO,OAAO,SAAS,OAAO,MAAM,EAAE,KAAK;AAAA,QACpD;AAEA,eAAO;AAAA,MACR,UAAE;AACD,oBAAY;AACZ,sBAAc;AAAA,MACf;AAAA,IACD,GAAG;AAEH,WAAO;AAAA,EACR;AACD,GAAG;",
  "names": []
}
